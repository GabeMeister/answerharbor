{% extends 'base.html' %}

{% block head_scripts %}
{% endblock %}


{% block content %}
    <div id="app">
        <form method="post" action="{{ url_for('new_post', homework_id=homework.id) }}">
            <span id="homework-post-count" style="display: none;">{{homework.posts|length}}</span>
            <h1>Create a New Question + Answer:</h1>

            <h3>Title:</h3>
            <div class="row">
                <div class="input-wrapper">
                    <input type="text" name="question_title" v-model="title" class="form-control" v-validate="'required'" placeholder="Enter question title"/>
                    <span v-show="errors.has('question_title')" v-text="errors.first('question_title')"></span>
                </div>
                <div class="preview-wrapper">
                    <h3 v-text="title" class="post-title-preview"></h3>
                </div>
            </div>

            <h3>Question:</h3>
            <div class="question-wrapper">
                <div class="row">
                    <div class="input-wrapper">
                        <textarea v-validate="'required'" :name="question.inputNameID" class="input-text-area form-control" rows="8" v-model="question.text" @keyup="update(question)" placeholder="Enter question text"></textarea>
                        <span v-show="errors.has(question.inputNameID)" v-text="errors.first(question.inputNameID)"></span>
                    </div>
                     <div class="preview-wrapper">
                        <p :id="question.bufferID" v-text="question.text" class="hidden-buffer"></p>
                        <p class="preview" :id="question.previewID" v-html="question.html"></p>
                    </div>
                </div>
            </div>

            <div class="answer-separator edit-post-space"></div>

            <h3>Answer Steps:</h3>
            <div class="steps-wrapper">
                <div class="row step-chunk" v-for="step in stepGroup.steps">
                    <div class="delete-btn-wrapper">
                        <img @click="deleteStep(step)" class="x-btn" src="/static/img/x-btn.png"/>
                    </div>
                    <div class="input-wrapper">
                        <textarea v-validate="'required'" :name="step.inputNameID" class="input-text-area form-control" rows="8" v-model="step.text" @keyup="update(step)" placeholder="Enter step text"></textarea>
                        <span v-show="errors.has(step.inputNameID)" v-text="errors.first(step.inputNameID)"></span>
                    </div>
                    <div class="preview-wrapper">
                        <p :id="step.bufferID" v-text="step.text" class="hidden-buffer"></p>
                        <p class="preview" :id="step.previewID" v-html="step.html"></p>
                    </div>
                </div><br/>

                <button class="btn btn-default" type="button" @click="addNewStep">New Step</button>
            </div>

            <h3>Final Answer:</h3>
            <div>
                <div class="row final-answer-row">
                    <div class="input-wrapper">
                        <textarea v-validate="'required'" :name="finalAnswer.inputNameID" class="input-text-area form-control" rows="4" v-model="finalAnswer.text" @keyup="update(finalAnswer)" placeholder="Enter final answer"></textarea>
                        <span v-show="errors.has(finalAnswer.inputNameID)" v-text="errors.first(finalAnswer.inputNameID)"></span>
                    </div>
                    <div class="preview-wrapper">
                        <p :id="finalAnswer.bufferID" v-text="finalAnswer.text" class="hidden-buffer"></p>
                        <p class="preview" :id="finalAnswer.previewID" v-html="finalAnswer.html"></p>
                    </div>
                </div>
            </div>

            <br/>
            <br/>
            <input class="btn btn-primary" @click="validateBeforeSubmit($event)" type='submit' value='Create Question + Answer'/>
        </form>
    </div>



{% endblock %}

{% block body_scripts %}
    <script type="text/javascript" src="/static/js/vue/new_post_app.js"></script>
{% endblock %}
